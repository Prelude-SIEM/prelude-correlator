#####
#
# Copyright (C) 2007 PreludeIDS Technologies. All Rights Reserved.
# Author: Yoann Vandoorselaere <yoann.v@prelude-ids.com>
#
# This file is part of the Prelude-Correlator program.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; see the file COPYING.  If not, write to
# the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.
#
#####

# Everyday between 09:00 PM and 06:00 AM, we are not on business hour.
schedule = * 21-5 * * *
$BUSINESS_HOUR = 0

# Saturday and sunday are not business hour.
schedule = * * * * 6,7
$BUSINESS_HOUR = 0

# Everyday except saturday and sunday, between 06:00 AM and 09:00 PM
# we are on business hour.
schedule = * 6-20 * * 1-5
$BUSINESS_HOUR = 1


pattern = assessment.impact.completion: succeeded; \
          messageid: (.+);                        \
          analyzer(*).analyzerid: (.*)

if $BUSINESS_HOUR == 0 {
        $ALERT = source = source; \
                 target = target; \
                 correlation_alert.alertident(>>).alertident = $1; \
                 correlation_alert.alertident(-1).analyzerid = $2[-1]; \
                 correlation_alert.name = Critical system activity on day off; \
                 classification = classification;

        alert = $ALERT
        destroy_context = $ALERT
}

